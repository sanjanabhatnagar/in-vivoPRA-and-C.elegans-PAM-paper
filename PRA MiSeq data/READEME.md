# 1. Processing cDNA MiSeq reads data and calculating PSI values

As described in the methods section, the quality scores of sequences generated from paired-end MiSeq multiplexed sequencing are assessed. The R1 and R2 files contain reads from both ends of the cDNA sequences. Before further analysis, these paired-end reads are merged into a single file to ensure both ends contribute to the calculation of PSI values for the corresponding reporter they map back to. This is followed by classifying the reads into different categories such as -
1. Spliced in isoforms
2. Spliced out isoforms
3. Unspliced isoforms
4. Cryptic spliced isoforms
5. Unknown isoforms

The script Splicing_Classifier_PRA_PSIcal.py is used to classify the reads as well as calculate the PSI values by collapsing reads using UMIs for each reporter, depicted by a unique barcode (which was introduced downstream of exon 3 in the minigene reporter and is thus present in the spliced isoforms) in the dataset. The script can be run as follows - 

```
python Splicing_Classifier_PRA_PSIcal.py CL1_merged.fastq
python Splicing_Classifier_PRA_PSIcal.py CL2_merged.fastq
```

This step parses out the barcodes from the reporter transcripts, thereby linking specific intronic PRA elements to the observed splicing patterns, as quantified by PSI values calculated which are within the same script. Once, the PSI values are obtained we perform Fishers Exact test to identify the intronic PRA elements with statistically significant effect on splicing. The p-values are further adjusted using False discovery rate < 0.01 (Benjamini-Hochberg procedure). 

The script FishersExactTest.py is run on the output file generated by Splicing_Classifier_PRA_PSIcal.py, containing the read counts and the corresponding PSI values. The p-values were adjusted manually for this using the abovementioned procedure. 


# 2. Identifying core k-mers within the identified splicing regulatory intronic PRA elements

## 2.1. Generation of k-mer count matrices for Neuronal and Muscle PRA elements

The intronic PRA elements are further scanned for k-mers {k=4,5,6,7}. This results in the generation of a k-mer count matrix where k-mers are the columns and the rows contain the corresponding counts in each PRA element. As mentioned in the study, we also incorporate flanking 3 nt from either end of the intronic PRA element to account for the cis-regulatory elements that might be potentially introduced at the junctions of the intronic element and the flanking intronic nts. 

The script kmer_count_matrix.py is used for the generation of k-mer count matrices for all neuronal and muscle PRA elements, separately. 

## 2.2. Univariate Linear Regression is performed for identification of core splicing regulatory k-mers

The k-mer count matrices generated from the previous step are used for this analysis. The PSI values of the corresponding PRA elements are regressed independently on the k-mer count vectors or simply put, on the k-mer counts. A k-mer is an independent variable whereas the PSI value is a dependent variable in this context. The k-mers present in at least 5 intronic PRA elements are used for this analysis.

The script UniLinearRegression_kmercounts_PSI.py is used for obtaining the regression coefficients/slopes and the associated p-values. These are further adjusted using False discovery rate < 0.05. Additionally, we report the splicing regulatory effects of k-mers using t-stat values. As mentioned in the methods section, this metric is chosen as it accounts for the standard error (or noise) in the regression weight assigned to a k-mer. It additionally, normalizes the weights of k-mers across datasets thus making the splicing regulatory effects comparable between k-mers of varying lengths.

## 2.3. Clustering of k-mers with significant tissue-specific splicing regulatory effects

The method described in the PEKA paper from Ule lab is used for clustering k-mers based on sequence similarity. 


