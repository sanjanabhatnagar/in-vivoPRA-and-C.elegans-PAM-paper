## 1. Processing cDNA MiSeq Reads and Calculating PSI Values

As described in the **Methods** section of the manuscript, this pipeline begins by assessing the quality of sequences generated from paired-end MiSeq multiplexed sequencing. The `R1` and `R2` files contain reads from both ends of the cDNA sequences. Prior to analysis, these paired-end reads are merged into a single file to ensure both ends contribute to the calculation of PSI values for the corresponding reporter they map back to.

The reads are then classified into the following categories:
1. Spliced-in isoforms  
2. Spliced-out isoforms  
3. Unspliced isoforms  
4. Cryptic spliced isoforms  
5. Unknown isoforms  

The script **`Splicing_Classifier_PRA_PSIcal.py`** performs the following functions:
- Classifies each read based on splicing status
- Collapses reads using Unique Molecular Identifiers (UMIs)
- Parses barcodes introduced downstream of exon 3 in the minigene reporter
- Calculates PSI values for each barcode, representing a unique reporter


```bash
python Splicing_Classifier_PRA_PSIcal.py CL1_merged.fastq
python Splicing_Classifier_PRA_PSIcal.py CL2_merged.fastq
```

This step extracts barcodes from reporter transcripts, linking specific intronic PRA elements to the observed splicing patterns, as quantified by the PSI values computed in the same script.

Once PSI values are calculated, **Fisher's Exact Test** is used to identify intronic PRA elements with statistically significant effects on splicing. P-values are corrected for multiple testing using a False Discovery Rate (FDR) < 0.01 (Benjamini-Hochberg method).

The script **`FishersExactTest.py`** is used on the output file generated by `Splicing_Classifier_PRA_PSIcal.py`, which contains both read counts and PSI values. The FDR correction was applied manually post-analysis.

---

## 2. Identifying Core k-mers within Splicing Regulatory Intronic PRA Elements

### 2.1. Generating k-mer Count Matrices for Neuronal and Muscle PRA Elements

Each intronic PRA element is scanned for k-mers of length 4 to 7 (`k = 4, 5, 6, 7`). This produces a k-mer count matrix where:
- Rows correspond to PRA elements
- Columns correspond to k-mers
- Values indicate the number of times each k-mer appears

As described in the study, 3 nucleotides flanking both ends of the PRA elements are included to capture junctional regulatory motifs.

The script **`kmer_count_matrix.py`** is used to generate separate count matrices for **neuronal** and **muscle** PRA elements.

---

### 2.2. Identifying Core Splicing Regulatory k-mers via Univariate Linear Regression

PSI values are independently regressed against k-mer counts. In this setup:
- **Independent variable**: k-mer count
- **Dependent variable**: PSI value

Only k-mers that appear in at least 5 intronic PRA elements are included in the analysis.

The script **`UniLinearRegression_kmercounts_PSI.py`** outputs:
- Regression coefficients (slopes)
- P-values (adjusted using FDR < 0.05)
- t-statistics to represent regulatory effect sizes

As described in the **Methods**, t-stat values are preferred as they normalize regression weights across datasets and account for standard error, enabling comparison across k-mers of different lengths.

---

### 2.3. Clustering k-mers with Tissue-specific Splicing Regulatory Effects

k-mers showing significant regulatory effects are clustered based on sequence similarity using methods described in the **PEKA** paper (Ule lab). This helps identify motifs with similar regulatory functions or shared binding specificities.
